<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <pre style="display: grid;" id="messages"></pre>
    <input type="text" id="mesg-box" />
    <button id="send">send message</button>
  </body>
  <script>
    (function(){
        const sendBtn = document.querySelector("#send");
        const messages = document.querySelector("#messages");
        const messageBox = document.querySelector("#mesg-box");
        const showMessage = (message) => {
          messages.textContent += `\n\n${message}`;
          messageBox.value = "";
        };
        const ws = new WebSocket("ws://localhost:6969");
        ws.onopen = () => {
          console.log("connection open");
        };
        ws.onmessage = ({ data }) => showMessage(data);
        ws.onclose = () => {
          ws = null;
        };
        sendBtn.addEventListener("click", () => {
          if (!ws) {
            showMessage("no connection");
          }
          ws.send(messageBox.value);
          showMessage(messageBox.value);
        });
    })() 
  </script>
</html>
